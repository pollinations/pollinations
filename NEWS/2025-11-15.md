# Weekly Update - 2025-11-15

- **Unify Service Tokens** — Unified `ENTER_TOKEN` values across `dev`, `staging`, and production environments for gateway and backend services to resolve 403 Unauthorized errors during inter-service communication. [PR #5310](https://github.com/pollinations/pollinations/pull/5310)
- **Remove Backend Model Defaults** — Removed default model fallbacks from `image.pollinations.ai` and `text.pollinations.ai`. Backends now throw errors for missing/invalid models, enforcing the gateway as the single source of truth for normalization. [PR #5308](https://github.com/pollinations/pollinations/pull/5308)
- **Test Reliability & Header Cleanup** — Removed unnecessary `Authorization` header forwarding to backend services (relying solely on `x-enter-token`) and improved test isolation, increasing pass rate from 60% to 74%. [PR #5305](https://github.com/pollinations/pollinations/pull/5305)
- **New Spore Subscription Tier** — Introduced "Spore" as the new entry-level tier to prevent fake account abuse. Updated tier hierarchy (Spore → Seed → Flower → Nectar → Router) across DB, UI, and Polar configuration. [PR #5304](https://github.com/pollinations/pollinations/pull/5304)
- **Remove Legacy Model Code** — Deleted unused `bpaigenModel.ts` and associated imports to clean up the codebase. [PR #5303](https://github.com/pollinations/pollinations/pull/5303)
- **Polar Sandbox Configuration** — Configured Polar Sandbox for development and staging environments, updating meter and product IDs to ensure correct subscription tier status fetching. [PR #5295](https://github.com/pollinations/pollinations/pull/5295)
- **Payment Checkout & UI Fixes** — Resolved CORS issues on checkout buttons by using direct navigation instead of `fetch`. Updated beta promotion messaging and placement within the `PollenBalance` component. [PR #5289](https://github.com/pollinations/pollinations/pull/5289)
- **Test & Type Cleanup** — Fixed failing tests, resolved type errors, and performed minor code cleanup. [PR #5287](https://github.com/pollinations/pollinations/pull/5287)
- **Update Pollen Pack IDs** — Renamed and updated Polar product IDs for pollen packs to `5X2`, `10X2`, `20X2`, and added `50X2` across all environments. [PR #5286](https://github.com/pollinations/pollinations/pull/5286)
- **Wrangler Deployment Fix** — Removed the environment flag from `wrangler deploy` to prevent conflicts with Vite-generated configurations where the environment is already baked in. [PR #5284](https://github.com/pollinations/pollinations/pull/5284)
- **OpenAPI Schema Cleanup** — Removed the internal `x-enter-token` header from the public OpenAPI documentation to prevent 403 errors and improve client compatibility. [PR #5283](https://github.com/pollinations/pollinations/pull/5283)
- **Dev Shell Improvements** — Added `fzf` for history search (Ctrl-R) to the Nix dev shell and improved `.encrypted.env` decryption logic for subdirectories. [PR #5282](https://github.com/pollinations/pollinations/pull/5282)
- **Biome Formatter Configuration** — Configured Biome as the default VS Code formatter with format-on-save, import sorting, and build folder exclusions. [PR #5274](https://github.com/pollinations/pollinations/pull/5274)
- **Fix Perplexity Citations** — Corrected the Portkey header typo to `x-portkey-strict-open-ai-compliance` to correctly disable strict compliance and enable Perplexity citations. [PR #5269](https://github.com/pollinations/pollinations/pull/5269)
- **Revert Direct Commits** — Reverted PR #5260 (error handling changes) which was accidentally merged directly to main. [PR #5266](https://github.com/pollinations/pollinations/pull/5266)
- **Tier Naming & Activation Refactor** — Renamed `assigned_tier` to `target_tier` and improved activation button logic to only appear when the target tier differs from the active tier. [PR #5261](https://github.com/pollinations/pollinations/pull/5261)
- **API Failure Fallback** — Implemented fallback text rendering for `LLMTextManipulator` and hidden decorative elements on API errors to improve UX during outages. [PR #5260](https://github.com/pollinations/pollinations/pull/5260)
- **Service Token Verification** — Added middleware to `image` and `text` services to verify the `x-enter-token` header, returning 403 Unauthorized for invalid requests. [PR #5259](https://github.com/pollinations/pollinations/pull/5259)
- **Restore Staging Environment** — Re-enabled the staging environment at `staging.enter.pollinations.ai` (Polar features currently disabled). [PR #5257](https://github.com/pollinations/pollinations/pull/5257)
- **Update Azure GPT Image Endpoint** — Updated `GPT_IMAGE_1_ENDPOINT` to the Poland Central region and refreshed API credentials. [PR #5255](https://github.com/pollinations/pollinations/pull/5255)
- **Production Deployment Config** — Updated GitHub workflows to trigger on `main`, renamed deploy command to `deploy:production`, and cleaned up staging references. [PR #5252](https://github.com/pollinations/pollinations/pull/5252)
- **Production Rate Limiter Binding** — Added missing `EDGE_RATE_LIMITER` binding to `wrangler.toml` for the production environment to fix 500 errors. [PR #5251](https://github.com/pollinations/pollinations/pull/5251)
- **Reduce Pollen Cache TTL** — Lowered cache TTL for customer state and meters from 60 seconds to 5 seconds for near real-time balance updates. [PR #5248](https://github.com/pollinations/pollinations/pull/5248)
- **Event Processing Fixes** — Moved batching logic to the front of the chain to isolate failing batches and added `eventId` tracking for debugging. [PR #5245](https://github.com/pollinations/pollinations/pull/5245)
- **Subscription UI Improvements** — Enhanced tier status display (active, ending, none), added cancellation warnings, and improved type safety with `PolarSubscription` interface. [PR #5242](https://github.com/pollinations/pollinations/pull/5242)
- **Sync React App** — Automated sync from `cloudcompile/pollinations-chat-ui/react-app`. [PR #5241](https://github.com/pollinations/pollinations/pull/5241)
- **Sync React App** — Automated sync from `cloudcompile/pollinations-chat-ui/react-app`. [PR #5240](https://github.com/pollinations/pollinations/pull/5240)
- **Edge Rate Limiter** — Implemented a general rate limiter (10 req/s per IP) for all proxy routes using Cloudflare native rate limiting. [PR #5239](https://github.com/pollinations/pollinations/pull/5239)
- **Model Usage Tracking Endpoint** — Added `/model-stats` endpoint and file-based counter system to track model request counts in real-time. [PR #5235](https://github.com/pollinations/pollinations/pull/5235)
- **Preserve Perplexity Citations** — Fixed response reconstruction to preserve the `citations` field from Perplexity API responses when strict OpenAI compliance is disabled. [PR #5232](https://github.com/pollinations/pollinations/pull/5232)
- **Update Project Attributions** — Replaced `@thomash` with `@voodoohop` in project configuration files and regenerated documentation. [PR #5225](https://github.com/pollinations/pollinations/pull/5225)
- **Mobile Tooltip Support** — Added click/tap functionality for pricing table tooltips on mobile devices while maintaining hover behavior on desktop. [PR #5222](https://github.com/pollinations/pollinations/pull/5222)
- **Fix Rate Limiter Stalls** — Removed the 30s timeout from `checkRateLimit()` to prevent requests from getting stuck when `consumePollen()` is bypassed by cache hits. [PR #5218](https://github.com/pollinations/pollinations/pull/5218)
- **Integrate Image Cache** — Integrated R2-based image caching directly into `enter.pollinations.ai` middleware, removing the need for a standalone cache worker. [PR #5217](https://github.com/pollinations/pollinations/pull/5217)
- **Simplify Image Proxy** — Removed semantic embedding code (BGE, Vectorize) and simplified the image worker to a thin proxy with R2 caching. [PR #5214](https://github.com/pollinations/pollinations/pull/5214)
- **Consistent Error Responses** — Reintroduced `UpstreamError` to preserve upstream HTTP status codes and provide structured error messages across proxy endpoints. [PR #5211](https://github.com/pollinations/pollinations/pull/5211)
- **Update Azure Credentials** — Updated `gptimage` model credentials and endpoint to a new Azure resource for improved stability. [PR #5209](https://github.com/pollinations/pollinations/pull/5209)
- **Model ID Tooltips** — Added tooltips to the pricing table to display the underlying model ID (e.g., `mistral-small-3.2...`) on hover. [PR #5201](https://github.com/pollinations/pollinations/pull/5201)
- **Reasoning Token Passthrough** — Enabled reasoning/thinking token passthrough for o1/o3, DeepSeek R1, and Claude models by disabling strict OpenAI compliance in Portkey. [PR #5198](https://github.com/pollinations/pollinations/pull/5198)
- **Fix Empty Image Cache** — Added validation to prevent caching or serving zero-byte images, resolving Opaque Response Blocking (ORB) errors in browsers. [PR #5195](https://github.com/pollinations/pollinations/pull/5195)
- **Update OpenAPI Documentation** — Added missing query parameters (width, height, seed, etc.) to the `/generate/image/{prompt}` endpoint schema. [PR #5194](https://github.com/pollinations/pollinations/pull/5194)
- **Simplify Pollen Rate Limiter** — Refactored the rate limiter to a minimal state design, removing complex token bucket logic in favor of a timestamp-based approach. [PR #5188](https://github.com/pollinations/pollinations/pull/5188)
- **Remove Analytics & Tracking** — Completely removed Tinybird analytics, Google Analytics, user blocking systems, and logging infrastructure. [PR #5186](https://github.com/pollinations/pollinations/pull/5186)
- **Migrate Sirius Cybernetics** — Migrated the Sirius Cybernetics project to the `enter.pollinations.ai` gateway and switched the model to Claude Haiku 4.5. [PR #5183](https://github.com/pollinations/pollinations/pull/5183)
- **Fix Image Prompt Encoding** — Fixed double-decoding issues for image prompts containing special UTF-8 characters when proxied through the gateway. [PR #5182](https://github.com/pollinations/pollinations/pull/5182)
- **New Community Projects** — Added ImaGenz, AI Image-to-Prompt Generator, and other community submissions to the project showcase. [PR #5179](https://github.com/pollinations/pollinations/pull/5179)
- **Rate Limiter Fixes** — Added missing awaits and fixed serialization issues in the pollen rate limiter logic. [PR #5178](https://github.com/pollinations/pollinations/pull/5178)
- **Sidebar Logo Fix** — Updated `Sidebar.jsx` to properly handle the rendering and display of the sidebar logo. [PR #5175](https://github.com/pollinations/pollinations/pull/5175)
- **Chat Vite Base Path** — Fixed the Vite base path configuration for `chat.pollinations.ai` deployment. [PR #5174](https://github.com/pollinations/pollinations/pull/5174)
- **MIDI Log Monitor Updates** — Added specific audio cues for error states: 403 Forbidden (tritone/MIDI 42) and 429 Rate Limited (consonant major sixth/MIDI 45) with appropriate dissonance levels. [PR #5169](https://github.com/pollinations/pollinations/pull/5169)
- **Error Status Code Preservation** — Updated error handling to preserve upstream HTTP status codes (400, 403, etc.) instead of wrapping them as 500. Introduced `HttpError` class and improved logging for `enter.pollinations.ai` and image models. [PR #5166](https://github.com/pollinations/pollinations/pull/5166)
- **Auth Debug Cleanup** — Removed undefined calls to `addAuthDebugHeaders` and `createAuthDebugResponse` remaining from previous refactors. [PR #5158](https://github.com/pollinations/pollinations/pull/5158)
- **Polar Production Migration Prep** — Updated `manage-polar.ts` with functions to transfer users/subscriptions and configured production product IDs. [PR #5152](https://github.com/pollinations/pollinations/pull/5152)
- **Payment UI Update** — Disabled the $5 pollen top-up button to maintain consistency with other payment options. [PR #5148](https://github.com/pollinations/pollinations/pull/5148)
- **Community Rewards Update** — Removed GitHub star incentives from the Pollen FAQ to ensure compliance with GitHub Terms of Service, focusing rewards on technical contributions. [PR #5147](https://github.com/pollinations/pollinations/pull/5147)
- **Legal & Identity Updates** — Comprehensive update to legal documents for GDPR compliance and company identity, establishing **Myceli.AI OÜ** details (Registry code: 17186693) and moving docs to `legal/` folder. [PR #5146](https://github.com/pollinations/pollinations/pull/5146)
- **Enter Image Cache Configuration** — Configured `pollinations-enter-image-cache` worker pointing to AWS EC2 origin with R2 bucket sharing, disabling semantic cache in favor of exact matching. [PR #5145](https://github.com/pollinations/pollinations/pull/5145)
- **Chat Interface Integration** — Added the `chat.pollinations.ai` interface code into the main repository. [PR #5144](https://github.com/pollinations/pollinations/pull/5144)
- **Seedream Reference Image Handling** — Implemented server-side download and base64 conversion for reference images to bypass hosting provider blocks (Cloudflare R2/ByteDance) and fix image-to-image failures. [PR #5143](https://github.com/pollinations/pollinations/pull/5143)
- **Kontext Model Tier Update** — Moved `kontext` model requirement from Seed to Nectar tier and updated error messages to direct users to `enter.pollinations.ai`. [PR #5141](https://github.com/pollinations/pollinations/pull/5141)
- **Discord Digest Month Fix** — Corrected the month index in the Discord Digest generator to properly handle 12 months (added "apr"). [PR #5136](https://github.com/pollinations/pollinations/pull/5136)
- **New Model: Grok 4 Fast** — Added `grok` (Grok 4 Fast non-reasoning) via Myceli Azure OpenAI-compatible endpoint. Aliases: `grok-fast`, `grok-4`. [PR #5131](https://github.com/pollinations/pollinations/pull/5131)
- **Deployment Trigger Fix** — Updated workflow to trigger `enter.pollinations.ai` deployment on changes to `shared/registry/**` (pricing/model configs). [PR #5130](https://github.com/pollinations/pollinations/pull/5130)
- **New Model: Claude Sonnet 4.5** — Added `claude-large` mapped to Claude Sonnet 4.5 via AWS Bedrock Fargate, supporting vision and tool calling. [PR #5129](https://github.com/pollinations/pollinations/pull/5129)
- **DeepSeek V3.1 Endpoint Update** — Updated DeepSeek V3.1 to use the new Azure OpenAI-compatible serverless endpoint (`myceli.services.ai.azure.com`). [PR #5128](https://github.com/pollinations/pollinations/pull/5128)
- **Authentication Consolidation** — Removed the deprecated `auth.pollinations.ai` service and consolidated all authentication logic and references to `enter.pollinations.ai`. [PR #5127](https://github.com/pollinations/pollinations/pull/5127)
- **Image Service Retry Logic** — Implemented automatic retry logic (max 3 attempts) for ComfyUI server 500 errors and enhanced error logging to capture response details. [PR #5126](https://github.com/pollinations/pollinations/pull/5126)
- **Tier Synchronization Script** — Added `sync-enter-auth-tiers.sh` to compare and sync user tiers between Enter (staging) and Auth (production) databases. [PR #5123](https://github.com/pollinations/pollinations/pull/5123)
- **Enhanced Tracking Events** — Added `userGithubId`, `userGithubUsername`, `apiKeyName`, and `modelProviderUsed` fields to tracking events. [PR #5111](https://github.com/pollinations/pollinations/pull/5111)
- **Rate Limiter & Test Infrastructure** — Implemented a callback function to track `consumePollen` in the frontend-key rate-limiter and improved the overall testing infrastructure. [PR #5110](https://github.com/pollinations/pollinations/pull/5110)
- **Discord Digest Workflow** — Updated digest generation to query GitHub directly using `POLLI_TOKEN` (removing storage dependencies) and set cron schedule to 12:00 UTC. [PR #5103](https://github.com/pollinations/pollinations/pull/5103)
- **Migrate CatGPT** — Migrated CatGPT to `enter.pollinations.ai`, switched to the `flux` model, and implemented API key authentication. [PR #5081](https://github.com/pollinations/pollinations/pull/5081)
