DESCRIPTION >
    Store OpenAI moderation results with cf_ray for joining with main events table

SCHEMA >
    `id` String `json:$.id` DEFAULT '',
    `timestamp` DateTime `json:$.timestamp`,

    -- OpenAI Moderation Parameters (severity levels and detection flags only)
    `hate_severity` LowCardinality(String) `json:$.hate.severity` DEFAULT 'safe',
    `self_harm_severity` LowCardinality(String) `json:$.self_harm.severity` DEFAULT 'safe',
    `sexual_severity` LowCardinality(String) `json:$.sexual.severity` DEFAULT 'safe',
    `violence_severity` LowCardinality(String) `json:$.violence.severity` DEFAULT 'safe',
    `protected_material_code_detected` Bool `json:$.protected_material_code.detected` DEFAULT false,
    `protected_material_text_detected` Bool `json:$.protected_material_text.detected` DEFAULT false

ENGINE "MergeTree" 
ENGINE_PARTITION_KEY "toYYYYMM(timestamp)"
ENGINE_SORTING_KEY "id"
ENGINE_PRIMARY_KEY "id"

FORWARD_QUERY > 
  SELECT id, defaultValueOfTypeName('DateTime') AS timestamp, hate_severity, self_harm_severity, sexual_severity, violence_severity, protected_material_code_detected, protected_material_text_detected

